<!DOCTYPE html><html><head><meta charset="utf-8"><title>Generate Python, Java, and .NET software libraries from a TypeScript source - Hari Menon</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Cross-posted from the AWS Blog post I wrote on the jsii compiler."><meta property="og:type" content="article"><meta property="og:title" content="Generate Python, Java, and .NET software libraries from a TypeScript source"><meta property="og:url" content="https://harimenon.com/2020/05/28/generate-python-java-dotnet-software-libraries-from-typescript-source/index.html"><meta property="og:site_name" content="Hari Menon"><meta property="og:description" content="Cross-posted from the AWS Blog post I wrote on the jsii compiler."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://harimenon.com/images/jsii.png"><meta property="article:published_time" content="2020-05-28T06:44:20.000Z"><meta property="article:modified_time" content="2021-05-24T19:55:47.154Z"><meta property="article:author" content="Hari Menon"><meta property="article:tag" content="AWS Blog"><meta property="article:tag" content="Cross-posted"><meta property="article:tag" content="Open Source"><meta property="article:tag" content="Developer Tools"><meta property="article:tag" content="AWS CDK"><meta property="article:tag" content="jsii"><meta property="article:tag" content="TypeScript"><meta property="article:tag" content="Python"><meta property="article:tag" content="Java"><meta property="article:tag" content="Dotnet"><meta property="article:tag" content="Polyglot"><meta property="article:tag" content="Micro-services"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://harimenon.com/images/jsii.png"><link rel="canonical" href="https://harimenon.com/2020/05/28/generate-python-java-dotnet-software-libraries-from-typescript-source/"><link rel="alternative" href="/atom.xml" title="Hari Menon" type="application/atom+xml"><link rel="icon" href="/favicon.png"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link href="//cdn.jsdelivr.net/smc-webfonts/latest/fonts/manjari.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet"><link href="/webfonts/ptserif/main.css" rel="stylesheet" type="text/css"><link href="/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css"><link href="/css/fonts/css/all.min.css" rel="stylesheet" type="text/css"><link href="/css/fonts/css/v4-shims.min.css" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/css/style.css"><script type="text/javascript">!function(e,a,t,n,g,c,o){e.GoogleAnalyticsObject=g,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),o=a.getElementsByTagName(t)[0],c.async=1,c.src="//www.google-analytics.com/analytics.js",o.parentNode.insertBefore(c,o)}(window,document,"script",0,"ga"),ga("create","UA-4869398-4","auto"),ga("send","pageview")</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="container"><header id="header"><div id="header-outer" class="outer"><div id="header-inner" class="inner"><a id="main-nav-toggle" class="fas nav-icon" href="javascript:;"></a> <a id="logo" class="logo" href="/"></a><nav id="main-nav"><a class="main-nav-link" href="/"><i title="Home" class="fa fa-home fa-2x fa-fw"><span class="nav-text">Home</span></i></a> <a class="main-nav-link" href="/about"><i title="About Me" class="fa fa-user-circle fa-2x fa-fw"><span class="nav-text">About Me</span></i></a> <a class="main-nav-link" href="/archives"><i title="Archives" class="fa fa-archive fa-2x fa-fw"><span class="nav-text">Archives</span></i></a> <a class="main-nav-link" href="/categories"><i title="Categories" class="fa fa-folder-open fa-2x fa-fw"><span class="nav-text">Categories</span></i></a> <a class="main-nav-link" href="/tags"><i title="Tags" class="fa fa-tags fa-2x fa-fw"><span class="nav-text">Tags</span></i></a> <a class="main-nav-link" href="/atom.xml"><i title="RSS" class="fa fa-rss fa-2x fa-fw"><span class="nav-text">RSS</span></i></a></nav><nav id="sub-nav"><div id="search-form-wrap"><form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://harimenon.com"></form></div></nav></div></div></header><section id="main" class="outer"><article id="post-generate-python-java-dotnet-software-libraries-from-typescript-source" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">Generate Python, Java, and .NET software libraries from a TypeScript source</h1></header><div class="article-meta"><a href="/2020/05/28/generate-python-java-dotnet-software-libraries-from-typescript-source/" class="article-date"><time datetime="2020-05-28T06:44:20.000Z" itemprop="datePublished">2020-05-28</time></a><div class="article-category"><a class="article-category-link" href="/categories/technical/">technical</a></div></div><div class="article-entry" itemprop="articleBody"><blockquote><p>Cross-posted from <a target="_blank" rel="noopener" href="https://aws.amazon.com/blogs/opensource/generate-python-java-dotnet-software-libraries-from-typescript-source/">the AWS Open Source Blog</a> article that I authored.</p></blockquote><p>As builders and developers, many of us are aware of the principle of <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">Don’t Repeat Yourself (or DRY)</a> and practice it every day. Entire runtimes and programming languages have been developed by taking that principle to an even higher level, with the core idea of writing software once and having it run on many different platforms, hardware, and operating systems. In this post, I explore the possibility of authoring and curating a software library in the TypeScript language, which at build time can then be generated into libraries in multiple other programming languages such as Python, Java, and .NET/C#. This is made possible by an open source software framework developed by AWS called <a target="_blank" rel="noopener" href="https://github.com/aws/jsii">jsii</a>, one of the core architectural components in the <a target="_blank" rel="noopener" href="https://aws.amazon.com/cdk/">AWS Cloud Development Kit</a> (AWS CDK).</p><img src="/images/jsii.png" width="600" title="jsii logo"> <span id="more"></span><p>AWS CDK is a software development framework to model and provision your cloud application resources in some popular programming languages. Within AWS CDK, jsii enables the authoring and maintenance of “<a target="_blank" rel="noopener" href="https://docs.aws.amazon.com/cdk/latest/guide/constructs.html">CDK constructs</a>” in the TypeScript language, and in turn generates those same constructs for other languages. Jsii creates type-annotated bundles from TypeScript modules and then auto-generates idiomatic libraries (or packages) in a variety of target languages. As detailed in <a target="_blank" rel="noopener" href="https://github.com/aws/jsii/blob/master/docs/runtime-architecture.md">jsii’s runtime architecture</a>, the generated types in these target languages proxy the calls to an embedded JavaScript VM, effectively allowing the jsii modules to be “written once and run everywhere.” Due to the performance of the hosted JavaScript engine and the marshaling costs, jsii modules are a good fit for generating development and build toolchains like the AWS CDK, but are not ideal for performance-sensitive applications or use cases.</p><h2 id="Getting-started-with-jsii"><a href="#Getting-started-with-jsii" class="headerlink" title="Getting started with jsii"></a>Getting started with jsii</h2><p><a target="_blank" rel="noopener" href="https://github.com/aws/jsii#getting-started">Getting started with jsii</a> is straightforward—create a new npm package:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init -y</span><br></pre></td></tr></table></figure><p>Ensure that <a target="_blank" rel="noopener" href="https://github.com/aws/jsii/blob/master/docs/configuration.md#additional-requirements--extensions">these additional requirements</a> are met for changing it into a jsii module:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;lib/index.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;types&quot;</span>: <span class="string">&quot;lib/index.d.ts&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;build&quot;</span>: <span class="string">&quot;jsii&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;build:watch&quot;</span>: <span class="string">&quot;jsii -w&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;package&quot;</span>: <span class="string">&quot;jsii-pacmak&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;author&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;John Doe&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;repository&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://github.com/aws-samples/jsii-code-samples.git&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Install the jsii toolchain as development dependencies into the package <code>- jsii</code> and <code>jsii-pacmak</code>.</p><pre><code>npm install --development jsii jsii-pacmak
</code></pre><p>Add <a target="_blank" rel="noopener" href="https://github.com/aws/jsii/blob/master/docs/configuration.md#the-jsii-section">a jsii section</a> into the package.json with the configuration for the generated <code>dotnet</code>, <code>java</code>, and <code>python</code> modules:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">&quot;jsii&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;outdir&quot;</span>: <span class="string">&quot;dist&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;targets&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;python&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;distName&quot;</span>: <span class="string">&quot;aws-jsiisamples.jsii-code-samples&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;module&quot;</span>: <span class="string">&quot;aws_jsiisamples.jsii_code_samples&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;java&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;package&quot;</span>: <span class="string">&quot;software.aws.jsiisamples.jsii&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;maven&quot;</span>: &#123;</span><br><span class="line">                    <span class="attr">&quot;groupId&quot;</span>: <span class="string">&quot;software.aws.jsiisamples.jsii&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;artifactId&quot;</span>: <span class="string">&quot;jsii-code-samples&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">&quot;dotnet&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;namespace&quot;</span>: <span class="string">&quot;AWSSamples.Jsii&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;packageId&quot;</span>: <span class="string">&quot;AWSSamples.Jsii&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>This should result in a <code>package.json</code> similar to <a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-code-samples/blob/master/package.json">this jsii code sample</a>, which also has continuous integration set up to deploy the jsii modules into package registries such as npm, PyPI, NuGet, and Maven.</p><h2 id="TypeScript-restrictions"><a href="#TypeScript-restrictions" class="headerlink" title="TypeScript restrictions"></a>TypeScript restrictions</h2><p>To keep the jsii modules compatible with all the supported languages, the jsii compiler restricts the TypeScript language features that can be used on the public API of the jsii modules being authored. This ensures that the proxy types for the public API of the module can then be generated in all of the supported languages. These restrictions and conventions are documented <a target="_blank" rel="noopener" href="https://github.com/aws/jsii/blob/master/docs/typescript-restrictions.md">on GitHub</a> and the compiler generates helpful error messages, along with instructions to resolve any violations.</p><p>To summarize, the restrictions over vanilla TypeScript include:</p><ul><li>Keywords from all the supported languages being enforced as reserved words</li><li>jsii conventions that view TypeScript interfaces as either:<ul><li>Behavioral Interfaces—must be prefixed with an uppercase I (similar to <code>IFoo</code>), or</li><li>Structs—must not have methods and are therefore pure data types.</li></ul></li></ul><p>As <a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-code-samples/blob/master/lib/index.ts">an example</a>, let’s look at a simple HelloWorld class with two public methods—a greeter and a Fibonacci generator:</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="title">sayHello</span>(<span class="params">name: <span class="built_in">string</span></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`Hello, <span class="subst">$&#123;name&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="title">fibonacci</span>(<span class="params">num: <span class="built_in">number</span></span>)</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> array = [<span class="number">0</span>, <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt; num + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            array.push(array[i - <span class="number">2</span>] + array[i - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array[num];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Performance-benchmarks-for-native-vs-jsii-modules"><a href="#Performance-benchmarks-for-native-vs-jsii-modules" class="headerlink" title="Performance benchmarks for native vs. jsii modules"></a>Performance benchmarks for native vs. jsii modules</h2><p>The above example library is built and published for JavaScript/TypeScript (at <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/jsii-code-samples">npm</a>), for Python (at <a target="_blank" rel="noopener" href="https://pypi.org/project/aws-jsiisamples.jsii-code-samples/">PyPI</a>), for Java (at <a target="_blank" rel="noopener" href="https://search.maven.org/artifact/software.aws.jsiisamples.jsii/jsii-code-samples">Maven Central</a>) and for .NET/C# (at <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/AWSSamples.Jsii/">NuGet</a>). These were compared against equivalent native implementations in the three generated languages to generate performance benchmarks.</p><p>First let’s take a quick look at the native implementations:</p><h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p>The Python implementation is shown below, can be seen in the <a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-native-python">jsii-native-python GitHub repo</a>, and is published to <a target="_blank" rel="noopener" href="https://pypi.org/project/aws-jsiisamples.jsii-native-python/">PyPI</a>:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">say_hello</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Hello, &#x27;</span> + name</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fibonacci</span>(<span class="params">self, n</span>):</span></span><br><span class="line">        table = [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">            table.append(table[i - <span class="number">2</span>] + table[i - <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> table[n]</span><br></pre></td></tr></table></figure><h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><p>The Java implementation is shown below and can be seen in the <a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-native-java">jsii-native-java GitHub repo</a>, and is published to <a target="_blank" rel="noopener" href="https://search.maven.org/artifact/software.aws.jsiisamples.java/jsii-native-java">Maven Central</a>:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello, &quot;</span> + name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">fibonacci</span><span class="params">(Integer num)</span> </span>&#123;</span><br><span class="line">        ArrayList&lt;Integer&gt; array = <span class="keyword">new</span> ArrayList&lt;&gt;(Arrays.asList(<span class="number">0</span>, <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; num + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            array.add(array.get(i - <span class="number">2</span>) + array.get(i - <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array.get(num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C"><a href="#C" class="headerlink" title="C#"></a>C#</h3><p>The C# implementation is as below and can be seen in the <a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-native-dotnet">jsii-native-dotnet GitHub repo</a> and is published to <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/AWSSamples.Jsii.Native/">NuGet</a>:</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HelloWorld</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">SayHello</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Hello, <span class="subst">&#123;name&#125;</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Fibonacci</span>(<span class="params"><span class="built_in">int</span> num</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        <span class="keyword">var</span> array = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt; &#123;<span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">2</span>; i &lt; num + <span class="number">1</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            array.Add(array[i - <span class="number">2</span>] + array[i - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> array[num];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Now let’s take a look at the benchmarking harnesses themselves, along with the benchmark results:</p><h3 id="Python-benchmarking-harness-using-the-built-in-timeit-module"><a href="#Python-benchmarking-harness-using-the-built-in-timeit-module" class="headerlink" title="Python benchmarking harness (using the built-in timeit module)"></a><a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-python-benchmarking">Python benchmarking harness</a> (using <a target="_blank" rel="noopener" href="https://docs.python.org/3.8/library/timeit.html">the built-in timeit module</a>)</h3><table><thead><tr><th></th><th align="right">jsii module</th><th align="right">Native module</th></tr></thead><tbody><tr><td>Windows</td><td align="right">14 ms/loop</td><td align="right">117 μs/loop</td></tr><tr><td>macOS</td><td align="right">6.7 ms/loop</td><td align="right">69.4 μs/loop</td></tr></tbody></table><p>The native Python implementation is two orders of magnitude faster than the jsii implementation.</p><h3 id="Java-benchmarking-harness-using-Java-Microbenchmark-Harness-JMH"><a href="#Java-benchmarking-harness-using-Java-Microbenchmark-Harness-JMH" class="headerlink" title="Java benchmarking harness (using Java Microbenchmark Harness (JMH))"></a><a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-java-benchmarking">Java benchmarking harness</a> (using <a target="_blank" rel="noopener" href="https://openjdk.java.net/projects/code-tools/jmh/">Java Microbenchmark Harness (JMH)</a>)</h3><table><thead><tr><th></th><th align="right">jsii module</th><th align="right">Native module</th></tr></thead><tbody><tr><td>Windows</td><td align="right">12,555.941 μs/op</td><td align="right">12.838 μs/op</td></tr><tr><td>macOS</td><td align="right">8,788.736 μs/op</td><td align="right">4.720 μs/op</td></tr></tbody></table><p>Unsurprisingly, in the case of Java, the native implementation is around three orders of magnitude faster than the jsii one.</p><h3 id="NET-benchmarking-harness-using-BenchmarkDotNet"><a href="#NET-benchmarking-harness-using-BenchmarkDotNet" class="headerlink" title=".NET benchmarking harness (using BenchmarkDotNet)"></a><a target="_blank" rel="noopener" href="https://github.com/aws-samples/jsii-dotnet-benchmarking">.NET benchmarking harness</a> (using <a target="_blank" rel="noopener" href="https://benchmarkdotnet.org/">BenchmarkDotNet</a>)</h3><table><thead><tr><th></th><th align="right">jsii module</th><th align="right">Native module</th></tr></thead><tbody><tr><td>Windows</td><td align="right">16,034.767 μs/op</td><td align="right">4.282 μs/op</td></tr><tr><td>macOS</td><td align="right">8,067.421 μs/op</td><td align="right">2.917 μs/op</td></tr></tbody></table><p>And in the case of .NET/C# once again, the native implementation is around three orders of magnitude faster than the jsii one.</p><h2 id="Potential-use-cases"><a href="#Potential-use-cases" class="headerlink" title="Potential use cases"></a>Potential use cases</h2><p>After recently discovering jsii while looking under the hood within AWS CDK, I was intrigued with the potential this compiler has for non-CDK use cases. Also, I have for a few years been helping to maintain <a target="_blank" rel="noopener" href="https://github.com/kollavarsham/kollavarsham-js">an open source library</a> that converts Gregorian calendar dates into <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Malayalam_calendar">Malayalam Era calendar</a> (which is one of the sidereal Indian calendar systems). At the time, that was only available as <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/kollavarsham">an npm package</a> for JavaScript/Node.js developers, but there were open requests to get it ported into other languages like <a target="_blank" rel="noopener" href="https://github.com/kollavarsham/kollavarsham.net">.NET/C#</a> and <a target="_blank" rel="noopener" href="https://github.com/kollavarsham/kollavarsham-python">Python</a>. In an attempt to understand jsii further, I modified the original ES6 codebase into jsii-compliant TypeScript, which helped to auto-generate the calculation-heavy library into <a target="_blank" rel="noopener" href="https://pypi.org/project/kollavarsham/">Python</a>, <a target="_blank" rel="noopener" href="https://search.maven.org/artifact/org.kollavarsham.converter/kollavarsham-converter">Java</a>, and <a target="_blank" rel="noopener" href="https://www.nuget.org/packages/KollavarshamOrg.Converter">C#</a>.</p><p>For any utility libraries like the computation-heavy calendar conversion example above, where the performance overheads shown in the previous section are acceptable, developing them once in jsii-compliant TypeScript and then getting them published for multiple languages can be a good productivity booster, especially today when polyglot microservices constituting a larger distributed application are commonplace.</p><h2 id="Support-for-more-languages"><a href="#Support-for-more-languages" class="headerlink" title="Support for more languages"></a>Support for more languages</h2><p>Similar to AWS CDK, the jsii library is developed as an open source library, and the community can and does influence the development of new features. The design goals for the library are documented in the <a target="_blank" rel="noopener" href="https://github.com/aws/jsii/blob/master/docs/specifications/1-introduction.md#design-tenets-unless-you-know-better-ones">jsii Design Tenets</a>, and there is <a target="_blank" rel="noopener" href="https://github.com/aws/jsii/blob/master/docs/specifications/5-new-language-intake.md">an established process</a> as well as <a target="_blank" rel="noopener" href="https://github.com/aws/jsii/blob/master/docs/handbooks/language-implementation.md">a handbook</a> for adding support for more languages to be auto-generated from the TypeScript source. With enough demand and contributions from the community, it is not far-fetched to think that other popular languages like Go, Rust, Ruby, etc. will also be supported in the future.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>If you need to build and maintain software libraries in multiple different programming language ecosystems, including TypeScript, and if their performance needs are within what the jsii-generated libraries will provide, get started using <a target="_blank" rel="noopener" href="https://github.com/aws/jsii">jsii</a> on your TypeScript libraries and auto-generate Python, Java, and .NET versions today.</p></div><footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aws-blog/" rel="tag">AWS Blog</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aws-cdk/" rel="tag">AWS CDK</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cross-posted/" rel="tag">Cross-posted</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/developer-tools/" rel="tag">Developer Tools</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dotnet/" rel="tag">Dotnet</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/micro-services/" rel="tag">Micro-services</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/open-source/" rel="tag">Open Source</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/polyglot/" rel="tag">Polyglot</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/typescript/" rel="tag">TypeScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jsii/" rel="tag">jsii</a></li></ul></footer></div><nav id="article-nav"><a href="/2021/01/04/far-from-home/" id="article-nav-newer" class="article-nav-link-wrap"><div class="article-nav-title"><span>&lt;</span>&nbsp; Infinity War</div></a><a href="/2020/04/27/wildfire/" id="article-nav-older" class="article-nav-link-wrap"><div class="article-nav-title">Wildfire!&nbsp;<span>&gt;</span></div></a></nav></article><section id="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></section><footer id="footer"><div class="outer"><div id="footer-info" class="inner" title="Generated on 20210524 155631">Copyright &copy; 2009 - 2021 Hari Menon&nbsp;| Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></div></div></footer><script>var disqus_shortname="harimenonenglishblog",disqus_url="https://harimenon.com/2020/05/28/generate-python-java-dotnet-software-libraries-from-typescript-source/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script src="/js/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/js/script.js"></script></div></body></html>